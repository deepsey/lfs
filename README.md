# Linux from scratch

## <a name='000'>–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ</a>  
[PART 01](#01)   
[PART 02](#02)   
[PART 03](#03)   
[PART 04](#04)   
[PART 05](#05)   
[PART 06](#06)   
[PART 07](#07)   
[PART 08](#08)   
[PART 09](#09)   
[PART 10](#10)   

---

##  <a name='01'>PART 01</a> 
1. –°–æ–∑–¥–∞–ª VM –Ω–∞ Debian 11 (Ubuntu 22.04) —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º HDD –Ω–∞ 40GB
2. –ù–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–º HDD —Å–æ–∑–¥–∞–ª LVM-—Ä–∞–∑–¥–µ–ª –Ω–∞ 20GB –∏ —Å–æ–∑–¥–∞–ª –Ω–∞ –Ω–µ–º ext4
``` 
apt install lvm2
pvcreate /dev/sdb
vgcreate vg0 /dev/sdb
lvcreate -L 20G -n lfs vg0 / lvcreate -l 100%FREE  -n lfs vg0
mkfs.ext4 /dev/vg0/lfs
vgdisplay vg0
lvdisplay /dev/vg0/lfs
```
–ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–≤–µ –∫–æ–º–∞–Ω–¥—ã - –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö VolumeGroup –∏ LogicalVolume. –î–ª—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –≤—ã–≤–æ–¥–∞ –∫—Ä–∞—Ç–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ LVM
```
pvs | vgs | lvs
```
![](lfs-001.jpg)

3. –°–æ–∑–¥–∞–ª –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é /mnt/lfs –∏ systemd mount unit –¥–ª—è –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —ç—Ç—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Ç–æ–º–∞ lfs
```
mkdir /mnt/lfs
```
–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —é–Ω–∏—Ç–∞ –¥–ª—è –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è `/etc/systemd/system/mnt-lfs.mount`:
```
[Unit]
Description=/mnt/lfs mount point

[Mount]
What=/dev/mapper/vg0-lfs
Where=/mnt/lfs
Type=ext4
DirectoryMode=0777
Options=defaults


[Install]
WantedBy=multi-user.target
```
–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —é–Ω–∏—Ç–∞ –¥–µ–ª–∞–µ–º 
```
systemctl daemon-reload
systemctl enable mnt-lfs.mount
systemctl start mnt-lfs.mount
systemctl status mnt-lfs.mount
```
–ü—Ä–æ–≤–µ—Ä—è–µ–º –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–º–∞ –∏ –∑–∞—Ç–µ–º –º–µ–Ω—è–µ–º –µ–≥–æ –≤–ª–∞–¥–µ–ª—å—Ü–∞
```
chown vagrant:vagrant /mnt/lfs
```
4. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–∏—Å—Ç–µ–º—É –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –Ω—É–∂–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ –¥–ª—è —Å–±–æ—Ä–∫–∏. –î–ª—è —ç—Ç–æ–≥–æ –∑–∞–ø—É—Å–∫–∞–µ–º —Å–∫—Ä–∏–ø—Ç –∏–∑ –∫–Ω–∏–≥–∏
```
./version-check.sh
```
–í –º–æ–µ–º —Å–ª—É—á–∞–µ –ø—Ä–∏—à–ª–æ—Å—å –¥–æ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞–∫–µ—Ç `texinfo` –∏ –∏–∑–º–µ–Ω–∏—Ç—å —Å—Å—ã–ª–∫—É `/bin/sh`, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∞ —É–∫–∞–∑—ã–≤–∞–ª–∞ –Ω–∞ —Ñ–∞–π–ª `/bin/dash` –≤–º–µ—Å—Ç–æ `/bin/bash`
```
apt install texinfo
ln -sf /bin/bash /bin/sh
```

5. –ù–µ–º–Ω–æ–≥–æ –Ω–µ –≤ —Ç–µ–º—É - –ø–æ–ª–µ–∑–Ω—ã–π –ø–∞–∫–µ—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–∞–∫–µ—Ç–∞, —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ –∏–º—è —Ñ–∞–π–ª–∞ - `apt-file`. –ù–∏–∂–µ –ø—Ä–∏–º–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–∞–∫–µ—Ç–∞, —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ `yacc`. 
```
apt install apt-file
apt-file update
apt-file search yacc | grep "yacc$"
```
[–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ](#000) 

---

##  <a name='02'>PART 02</a> 

üî∑ 1. –£—Å—Ç–∞–Ω–æ–≤–∏–º –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é $LFS. –í —Ñ–∞–π–ª ~/.bashrc –ø—Ä–æ–ø–∏—à–µ–º
```
export LFS=/mnt/lfs
```
üî∑ 2. –°–∫–∞—á–∏–≤–∞–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã. –°–ø–∏—Å–æ–∫ –º–æ–∂–Ω–æ –≤–∑—è—Ç—å –æ—Ç—Å—é–¥–∞: https://www.linuxfromscratch.org/lfs/downloads/11.1/wget-list  
üî∑ 3. –ü–æ–¥—Å—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞–∫–µ—Ç–æ–≤ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è:
```
wc -l wget-list
93 wget-list
```
üî∑ 4. –°–æ–∑–¥–∞–¥–∏–º —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –ø–∞–∫–µ—Ç–æ–≤ `wget.sh`:
```
#!/bin/bash
wget --input-file=wget-list --continue --directory-prefix=$LFS/sources
```
`--input-file` - —Ñ–∞–π–ª —Å–æ —Å–ø–∏—Å–∫–æ–º –¥–ª—è –∑–∞–∫–∞—á–∫–∏
`--continue` - –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –∑–∞–∫–∞—á–∫—É –ø—Ä–∏–æ–±—Ä—ã–≤–µ
`--directory-prefix` - —Ü–µ–ª–µ–≤–∞—è –¥–∏—Ç–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Å–∫–∞—á–∏–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤  

üî∑ 5. –°–æ–∑–¥–∞–¥–∏–º —Ü–µ–ª–µ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
```
mkdir $LFS/sources
```
üî∑ 6. –ó–∞–ø—É—Å–∫–∞–µ–º —Å–∫—Ä–∏–ø—Ç `wget.sh` –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `$LFS/sources`
```
ls -1 $LFS/sources | wc -l
91
```
---
–ú–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–∫–∞—á–∫—É —Ñ–∞–π–ª–æ–≤ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—è –∑–∞–ø—É—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ. –î–ª—è —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—Å—Ç–æ–π —Å–∫—Ä–∏–ø—Ç:
```
for i in `cat wget-list`; do wget $i --continue --directory-prefix=$LFS/sources & done
```
--- 
–í–∏–¥–∏–º, —á—Ç–æ –∫–∞–∫–∏–µ-—Ç–æ –¥–≤–∞ —Ñ–∞–π–ª–∞ –Ω–µ —Å–∫–∞—á–∞–ª–∏—Å—å. –ö–∞–∫ –Ω–∞–º –∏—Ö –Ω–∞–π—Ç–∏? –°–∫–æ–ø–∏—Ä—É–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `$LFS/sources` –≤ —Ñ–∞–π–ª `local_files` —Å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π —Å—Ç—Ä–æ–∫
```
ls -1 sources | sort > local_files
```
–¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–¥–∏–º —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –¥–æ–ª–∂–Ω—ã –±—ã–ª–∏ –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏ –∏–∑ `wget-list`. –î–ª—è —ç—Ç–æ–≥–æ –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è –∫–æ–º–∞–Ω–¥–æ–π `awk`
```
awk -F"/" '{print $NF}' wget-list | sort > wget_files
```
-F"/" - –æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –ø–æ–ª–µ–π, —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º—ã –º–æ–∂–µ–º —Ä–∞–∑–±–∏—Ç—å –∫–∞–∂–¥—É—é —Å—Ç—Ä–æ—á–∫—É wget-list –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã, —Ä–∞–∑–¥–µ–ª—è–µ–º—ã–µ —Å–ª—ç—à–µ–º  
'{print $NF}' - –≤—ã–≤–µ—Å—Ç–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π ($NF) —ç–ª–µ–º–µ–Ω—Ç —Å—Ç—Ä–æ–∫–∏

–í–µ—Å—å –≤—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥—ã –º—ã –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –≤ —Ñ–∞–π–ª `wget_files`, –ø–æ–ª—É—á–∏–≤ –≤ –Ω–µ–º –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –¥–æ–ª–∂–Ω—ã –±—ã–ª–∏ –ø–æ–ª—É—á–∏—Ç—å. –¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º —Å—Ä–∞–≤–Ω–∏—Ç—å –¥–≤–∞ —Ñ–∞–π–ª–∞ –∏ –ø–æ–Ω—è—Ç—å, –∫–∞–∫–∏–µ –ø–∞–∫–µ—Ç—ã —É –Ω–∞—Å –Ω–µ —Å–∫–∞—á–∞–ª–∏—Å—å:
```
diff local_files wget_files
```
–í –∏—Ç–æ–≥–µ –Ω–µ —Å–∫–∞—á–∞–ª–æ—Å—å –¥–≤–∞ –∞—Ä—Ö–∏–≤–∞: zlib-1.2.11.tar.xz –∏ expat-2.4.6.tar.xz. –í–º–µ—Å—Ç–æ zlib-1.2.11.tar.xz –±—ã–ª —Å–∫–∞—á–µ–Ω zlib-1.3.1.tar.xz, –∞ expat-2.4.6.tar.xz –±—ã–ª –∑–∞–∫–∞—á–µ–Ω –∏–∑ –¥—Ä—É–≥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞.
```
wget https://zlib.net/zlib-1.3.1.tar.xz --continue --directory-prefix=$LFS/sources
wget https://github.com/libexpat/libexpat/releases/tag/R_2_4_6/expat-2.4.6.tar.xz --continue --directory-prefix=$LFS/sources
```
–ü–æ—Å–ª–µ –ø–æ–≤—Ç—Ä–µ–Ω–∏—è –ø—Ä–æ—Ü–µ–¥—É—Ä—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∏ —Å–∫–∞—á–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ —É–±–µ–¥–∏–ª–∏—Å—å, —á—Ç–æ —Ç–µ–ø–µ—Ä—å –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∞—Ä—Ö–∏–≤—ã —É –Ω–∞—Å –µ—Å—Ç—å.

üî∑ 7. –¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–¥–∏–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã LFS. –î–ª—è —ç—Ç–æ–≥–æ –∑–∞–ø—É—Å–∫–∞–µ–º —Å–∫—Ä–∏–ø—Ç dir.sh
```
#!/bin/bash
mkdir -pv $LFS/{etc,var} $LFS/usr/{bin,lib,sbin}
for i in bin lib sbin; do
ln -sv usr/$i $LFS/$i
done
case $(uname -m) in
x86_64) mkdir -pv $LFS/lib64 ;;
esac
```
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é tools
```
mkdir -pv $LFS/tools
```
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ $LFS –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫:
```
/mnt/lfs
‚îú‚îÄ‚îÄ bin -> usr/bin
‚îú‚îÄ‚îÄ etc
‚îú‚îÄ‚îÄ lib -> usr/lib
‚îú‚îÄ‚îÄ lib64
‚îú‚îÄ‚îÄ local_files
‚îú‚îÄ‚îÄ lost+found [error opening dir]
‚îú‚îÄ‚îÄ sbin -> usr/sbin
‚îú‚îÄ‚îÄ sources
‚îú‚îÄ‚îÄ tools
‚îú‚îÄ‚îÄ usr
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ bin
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ lib
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ sbin
‚îú‚îÄ‚îÄ var
```
üî∑ 8. –ü–æ–¥–≥–æ—Ç–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –î–ª—è —á–µ–≥–æ —ç—Ç–æ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –Ω—É–ª—è. –ó–∞—á–µ–º?
–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –æ–∫—Ä—É–∂–µ–Ω–∏–∏ –∫ –Ω–µ–º—É –º–æ–≥—É—Ç –ø–æ–¥—Ç—è–Ω—É—Ç—å—Å—è –æ–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö "—Å–∫–µ–ª–µ—Ç–Ω—ã—Ö" —Ñ–∞–π–ª–æ–≤, –≤ —Ç–æ–º —á–∏—Å–ª–µ .bashrc, .profile –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.  
–£ –Ω–∞—Å –µ—Å—Ç—å –¥–≤–∞ —Ñ–∞–π–ª–∞, –∫–æ—Ç–æ—Ä—ã–µ, –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –æ—Ç–≤–µ—á–∞—é—Ç –∑–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö - .bashrc –∏ .profile (bash profile)  
.profile –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç –Ω–∞—à–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ —Ç–æ–º —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –º—ã –∑–∞—Ö–æ–¥–∏–º —É–¥–∞–ª–µ–Ω–Ω–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä. –ö–æ–≥–¥–∞ –º—ã –≤–≤–æ–¥–∏–º –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å, –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å —Å—Ç–∞—Ä—Ç—É–µ—Ç bash profile.  
–¢–∞–∫ –∂–µ –µ—Å—Ç—å —Ñ–∞–π–ª /etc/bash.bashrc, –∫–æ—Ç–æ—Ä—ã–π —Ç–æ–∂–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–æ–º–∞–Ω–¥–Ω–æ–π –æ–±–æ–ª–æ—á–∫–∏, –æ–Ω –Ω–∞–º –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ LFS –Ω–µ –Ω—É–∂–µ–Ω.  
–ù–∞–º –Ω—É–∂–µ–Ω —á–∏—Å—Ç—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, —É –∫–æ—Ç–æ—Ä–≥–æ –Ω–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤ –æ–±—â–µ–π —Å–∏—Å—Ç–µ–º–µ.  
–î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è lfs, –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –≤ –≥—Ä—É–ø–ø—É lfs, —Å–æ–∑–¥–∞–µ–º –¥–ª—è –Ω–µ–≥–æ –ø–∞—Ä–æ–ª—å, –¥–∞–µ–º –µ–º—É –ø—Ä–∞–≤–∞ sudo –∏ –¥–µ–ª–∞–µ–º –µ–≥–æ –≤–ª–∞–¥–µ–ª—å—Ü–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ $LFS
```
groupadd lfs
useradd -s /bin/bash -g lfs -m -k /dev/null lfs
passwd lfs
usermod -aG sudo lfs
chown -v lfs $LFS/sources
```
---
–í –∫–æ–º–∞–Ω–¥–µ useradd:   
**-s /bin/bash** - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±–æ–ª–æ—á–∫—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é  
**-g** - —É–∫–∞–∑—ã–≤–∞–µ–º –≥—Ä—É–ø–ø—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
**-m** - —Å–æ–∑–¥–∞–µ–º –¥–æ–º–∞—à–Ω—é—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é  
**-k** - —É–∫–∞–∑–∞–Ω–∏–µ –Ω–∞ —Å–∫–µ–ª–µ—Ç–Ω—ã–π —Ñ–∞–π–ª, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Å–Ω–æ–≤–æ–π –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ —Ç–∫–æ–≥–æ —Ñ–∞–π–ª–∞ –Ω–µ—Ç (/dev/null), —Ç.–µ. –¥–æ–º–∞—à–Ω–∏–π –∫–∞—Ç–∞–ª–æ–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±—É–¥–µ—Ç –ø—É—Å—Ç–æ–π  

---

üî∑ 9. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–∞–±–æ—á–µ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è lfs.
–í .bash_profile –≤—Å—Ç–∞–≤–ª—è–µ–º —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä–æ–∫—É
```
exec env -i HOME=$HOME TERM=$TERM PS1='\u:\w\$ ' /bin/bash
```
–í —ç—Ç–æ–º —Ñ–∞–π–ª–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö HOME, TERM, PS1, –∞ —Ç–∞–∫–∂–µ –ø–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç—Å—è —Ñ–∞–π–ª bashrc.  
–ü—Ä–∏ –≤—Ö–æ–¥–µ –≤ –≤—Å–∏—Å—Ç–µ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º lfs –æ–±—ã—á–Ω–æ —Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ª–æ–≥–∏–Ω —Ñ–∞–π–ª /etc/profile, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è, –∞ –∑–∞—Ç–µ–º .bash_profile. –ü—Ä–∏–≤–µ–¥–µ–Ω–Ω–∞—è –≤—ã—à–µ –∫–æ–º–∞–Ω–¥–∞ –∑–∞–º–µ–Ω—è–µ—Ç –∑–∞–ø—É—Å–∫–∞–µ–º—É—é –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ–±–æ–ª–æ—á–∫—É –Ω–æ–≤–æ–π —Å –ø—É—Å—Ç—ã–º –æ–∫—Ä—É–∂–µ–Ω–∏–µ–º, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö HOME, TERM –∏ PS1.  
–ù–æ–≤—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä shell —è–≤–ª—è–µ—Ç—Å—è non-login shell, –∫–æ—Ç–æ—Ä—ã–π —á–∏—Ç–∞–µ—Ç –∏ –∏—Å–ø–æ–ª–Ω—è–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ .bashrc, –∞ –Ω–µ —Ñ–∞–π–ª–æ–≤ /etc/profile –∏–ª–∏ bash profile.  
–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–ª–µ–¥—É—é—â–µ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ .bashrc
```
set +h
umask 022
LFS=/mnt/lfs
LC_ALL=POSIX
LFS_TGT=$(uname -m)-lfs-linux-gnu
PATH=/usr/bin
if [ ! -L /bin ]; then PATH=/bin:$PATH; fi
PATH=$LFS/tools/bin:$PATH
CONFIG_SITE=$LFS/usr/share/config.site
export LFS LC_ALL LFS_TGT PATH CONFIG_SITE
```
---
**set +h** - –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ hash-—Ñ—É–Ω–∫—Ü–∏–∏ bash  
**umask** - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–∞–≤–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é  
**LFS, LC_ALL, LFS_TGT** - –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è–Æ, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è —Å–±–æ—Ä–∫–∏ –∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏  
**PATH** - –ø—É—Ç—å –¥–æ –ø–∞–ø–∫–∏ —Å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏  
**if [ ! -L /bin ]; then PATH=/bin:$PATH; fi** - –µ—Å–ª–∏ –≤ –Ω–∞—à–µ–π —Å–∏—Å—Ç–µ–º–µ –∫–∞—Ç–∞–ª–æ–≥ /bin —è–≤–ª—è–µ—Ç—Å—è —Å–∏–º–ª–∏–Ω–∫–æ–º, —Ç–æ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é PATH –¥–æ–±–∞–≤–ª—è–µ–º –∫–∞—Ç–∞–ª–æ–≥ /bin  
**PATH=$LFS/tools/bin:$PATH** - –¥–æ–±–∞–≤–ª—è–µ–º –≤ PATH $LFS/tools/bin  
**export LFS LC_ALL LFS_TGT PATH CONFIG_SITE** - —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —Ç.–µ. –æ–Ω–∏ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –¥–æ—á–µ—Ä–Ω–∏—Ö –∫–æ–º–∞–Ω–¥–Ω—ã—Ö –æ–±–æ–ª–æ—á–∫–∞—Ö  

---

üî∑ 10. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –Ω–∞ –¥–æ–º–∞—à–Ω–∏–π –∫–∞—Ç–∞–ª–æ–≥ lfs:
```
chown -R lfs:lfs /home/lfs
```

üî∑ 11. –ï—Å–ª–∏ –≤ —Å–∏—Å—Ç–µ–º–µ –µ—Å—Ç—å —Ñ–∞–π–ª /etc/bash.bashrc, —Ç–æ –µ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–±—Ä–∞—Ç—å:
```
[ ! -e /etc/bash.bashrc ] || mv -v /etc/bash.bashrc /etc/bash.bashrc.NOUSE
```
   
üî∑ 12. –ò —Å–æ–∑–¥–∞–µ–º –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –∑–∞–ª–æ–≥–∏–Ω–∏–≤—à–∏—Å—å –æ—Ç –µ–≥–æ –∏–º–µ–Ω–∏
```
source ~/.bash_profile
```

üî∑ 13. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–∞–≤–∞ –Ω–∞ –∫–∞—Ç–∞–ª–æ–≥ /mnt/lfs
```
chown -R lfs:lfs /mnt/lfs
```
üî∑ 14.  –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –Ω–∞ –ø–∞–ø–∫—É sources 1777 (—Å—Ç–∏–∫–∏ –±–∏—Ç - –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Ö–æ—Å—Ç–∞ –±—É–¥—É—Ç –∏–º–µ—Ç—å –ø—Ä–∞–≤–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ñ–∞–π–ª—ã –≤ –∫–∞—Ç–∞–ª–æ–≥–µ sources (–Ω–æ –Ω–µ —É–¥–∞–ª—è—Ç—å))
```
chmod -v a+wt $LFS/sources
```
[–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ](#000)

---

##  <a name='03'>PART 03</a> 
  
SBU - Standrad Build Unit, —Å–≤–æ–µ–≥–æ —Ä–æ–¥–∞ –∏–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏—Ç–æ–π –∏–ª–∏ –∏–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã. –ó–∞ –æ—Ü–µ–Ω–æ—á–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –±–µ—Ä–µ—Ç—Å—è –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –ø–∞–∫–µ—Ç–∞ binutils. –ò–º–µ–Ω–Ω–æ —Å –Ω–µ–≥–æ –∏ –Ω–∞—á–∏–Ω–∞–µ–º –∫–æ–º–ø–∏–ª—è—Ü–∏—é.  

 ### 1. Chapter 5. Compiling a Cross-Toolchain  
 üî∑ **Binutils-2.37**  
–†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º –∞—Ä—Ö–∏–≤ –≤ –ø–∞–ø–∫–µ sources
```
tar xvf binutils-2.38.tar.xz
````
–ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –∫–∞—Ç–∞–ª–æ–≥ /mnt/lfs/sources/binutils-2.38  
–ü—Ä–∏–º–µ–Ω—è–µ–º –ø–∞—Ç—á –¥–ª—è –ø–∞–∫–µ—Ç–∞
```
patch -Np1 < ../binutils-2.38-lto_fix-1.patch
```
-N - –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ç—á–∞, –µ—Å–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –∫–∞–∫–∞—è-—Ç–æ –æ—à–∏–±–∫–∞, —Å —Ç–æ–≥–æ –∂–µ –º–µ—Å—Ç–∞  
p1 - —É–±—Ä–∞—Ç—å —á–∞—Å—Ç—å –ø—É—Ç–∏ –æ—Ç –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞  

–ü–æ –æ–∫–æ–Ω—á–∞–Ω–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–¥ –≤–æ–∑–≤—Ä–∞—Ç–∞, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—Å—è, —á—Ç–æ –Ω–µ –ø—Ä–æ–∏–∑–æ—à–ª–æ –æ—à–∏–±–æ–∫
  ```
  lfs:/mnt/lfs/sources/binutils-2.38$ echo $?  
  0
  ```
–°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é build –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –Ω–µ–µ
```
mkdir -v build
cd build
```
–ó–∞–ø—É—Å–∫–∞–µ–º configure –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è Makefile
```
../configure --prefix=$LFS/tools --with-sysroot=$LFS --target=$LFS_TGT --disable-nls --disable-werror
```
--prefix - –∫—É–¥–∞ –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–∞–∫–µ—Ç  
--with-sysroot - sysroot –¥–ª—è –ø–∞–∫–µ—Ç–∞ –±—É–¥–µ—Ç /mnt/lfs  
--disable-werror - –æ—Ç–∫–ª—é—á–∞–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è  

–ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–¥ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∏ –Ω–∞–ª–∏—á–∏–µ Makefile - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ —è–∑—ã–∫–∞ make, —Ç.–µ. —É–∫–∞–∑–∞–Ω–æ, —á—Ç–æ –¥–µ–ª–∞—Ç—å —É—Ç–∏–ª–∏—Ç–µ make. –¢.–µ. make –Ω–µ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç, –∞ –ø—Ä–æ—Å—Ç–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–º–∞–Ω–¥—ã –∏–∑ —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞, –Ω–µ –±–æ–ª–µ–µ —Ç–æ–≥–æ.  

3. 

4. 
   




5. 
